\section{The Fluctuation Dissipation Theorem}

The fluctuation dissipation theorem is a corner stone of near-equilibrium statistical mechanics. There are many different presentations of the theorem, however the underlying idea is the same: the relation of an equilibrium average, in our case that of a correlation function, to the response of an observable that has been weekly perturbed from it's equilibrium state.

Following Livi \cite{LiviPoliti2017} let us present a derivation of the fluctuation dissipation theorem in a bit more detail. The experimental set up is as follows, we consider a thermodynamic system consisting of $N$ particles obeying the laws of classical mechanics. We assume the system has reached an equilibrium and can thus be described by the canonical ensemble \cite{Greiner1995}. We will be interested in measuring the response of a thermodynamic observable $X$ to a weak perturbation $h$, where $h$ and $X$ are conjugate variables. Our presentation will be in three steps.

First we consider the case where $h$ is a constant perturbation that shifts the equilibrium. The perturbation will then be turned off and we will look at how $X$ relaxes to the unperturbed equilibrium. Secondly, we will introduce the repsonse function $\chi$ that will allow us to generalise our argument for a time dependent perturbation $h(t)$. Finally, we will look at the fourier transform of $\chi$. For a review of the assumed Statistical Mechanics, Thermodynamics and Classical Mechanics we point the reader to \cite{Greiner1995}, \cite{JudithA.McGovern2016} and \cite{JohnBaez} respectively.\\

\subsection{Constant Perturbation Field}

We first consider the case where a constant perturbation field $h$ is turned on and our system relaxes to a new equilibrium state. At $t = 0$ the field will be turned off, and our system will relax back to the original equilibrium value due to the presence of a thermal bath. In the unperturbed state, the dynamics will be described by the Hamiltonian $\mathcal{H}$, whilst when the perturbation field is on, the dynamics will be described by the Hamiltonian $\mathcal{H}' = \mathcal{H} -hX$. We are interested in the value of our observable during the relaxation period:

\begin{align}
\expval{X(t)} &= \frac{\int \dd \mathcal{V} X(t) e^{-\beta \left( \mathcal{H}-hX(0) \right) }  }{\int \dd \mathcal{V} e^{-\beta \left( \mathcal{H}-hX(0) \right) }}. \label{relaxVal}
\end{align}

\noindent The idea in \ref{relaxVal} is that for $t >0$ the dynamics will be described the solution $X(t)$ for the Hamiltonian equations given by $\mathcal{H}$. These can be solved given an initial condition $X(0)$, which we will weight each solution by. Next since we are assuming $h$ is small, we can linearise:

\begin{align}
\expval{X(t)} \approx \frac{\int \dd \mathcal{V} X(t) e^{-\beta \mathcal{H} } \left(1 +\beta h X(0) \right)  }{\int \dd \mathcal{V} e^{-\beta\mathcal{H} } \left(1 +\beta h X(0) \right)},
\end{align}

\noindent we now divide the numerator and denominator on the right hand side by the unperturbed partition function $Z_0$:

\begin{align}
\expval{X(t)} = \frac{\expval{X(t) \left(1 +\beta h X(0) \right) }_0}{\expval{\left(1 +\beta h X(0) \right)}_0},
\end{align}

\noindent where $\expval{ \ldots }_0$ denotes the unperturbed equilibrium expected value. Rearranging we then arrive at a form of the FDT:

\begin{align}
\expval{X(t)} - \expval{X}_0 = \beta h \left( \expval{X(t)X(0)}_0 - \expval{X}_0 ^2 \right).\label{FDT1}
\end{align}

Note the conceptual implications of \ref{FDT1}, the right hand side is obtained purely from the equilibrium state whilst the left hand side is near-equilibrium relaxation. Here then we have a bridge between equilibrium fluctuations and near-equilibrium perturbations. 

\subsection{Time Dependent Perturbations}

The power of \ref{FDT1} is that it will allow us deduce the response function $\chi$. This means we can then calculate the response for a general time dependent perturbation.  Without loss of generality we will assume $\expval{X}_0 = 0$. First let's look at $\chi$ for the forcing that we used to derive \ref{FDT1}:

\begin{align}
h(t) = 
\begin{dcases}
h & t<0 \\
0 & t \geq 0
\end{dcases}
\end{align}

\noindent we have: 

\begin{align}
\expval{X(t)} &= \chi * h(t) \\
&= h \int_{-\infty}^0 \dd t' \chi(t - t') \label{chiForh}
\end{align}

\noindent where we have used the time invariance and causality of $\chi$. Comparing \ref{chiForh} with \ref{FDT1} we can relate $\chi$ to the fluctuations:

\begin{align}
 \int_{-\infty}^0 \dd t' \chi(t - t') = \beta \expval{X(t)X(0)}_0 .
\end{align}

\noindent To arrive at a more general form of the FDT, namely one that gives $\chi$ we first take the time derivative of both sides, applying the fundamental theorem of calculus on the left. Then we multiply both sides by $\Theta$, noting that it is an identity element for causal functions. This simple calculations gives:

\begin{align}
\chi(t) = - \beta \Theta (t) \dv{t}\expval{X(t)X(0)}_0  \label{FDT}
\end{align}

\noindent As discussed in section \ref{Section: Response Functions}, $\chi$ allows us to calculate the response to a general time dependent forcing. The power of \ref{FDT} is that it gives us way to find the response function looking only at an equilibrium correlation function.

\subsection{Fourier Point of View}

Another point of view on the FDT can be gained from working with the Fourier transform of \ref{FDT}: 

\begin{align}
\chi(\omega) = - \beta \int_{-\infty}^{\infty} \dd t  e^{-\omega t} \Theta(t) \dv{t}\expval{X(t)X(0)}_0
\end{align}

\noindent which can be rewritten using the convolution theorem and the time derivative properties of Fourier transforms, (namely $\mathcal{F} \left( \dv{x}{t} \right) = i \omega \mathcal{F} (x)$). Specifically we have:

\begin{align}
\chi(\omega) &= - \frac{\beta}{2 \pi} \int_{-\infty}^{\infty} \dd \omega ' \Theta(\omega - \omega ') \expval{X(\omega)X(0)}_0.
\end{align}

\noindent Solving this integral takes some care and we point the reader to page $82$ of \cite{LiviPoliti2017} for the details. The key point is that one can recover the imaginary part of the transformed response function:

\begin{align}
\Im{ \chi(\omega)} = - \beta \frac{\omega}{2} \expval{X(\omega)X(0)}_0
\end{align}

\noindent This is significant in light of the Kramers-Kronig relations from section \ref{secition:Kramers-Kronig}, as we can now construct $\chi(\omega)$ from $\expval{X(\omega)X(0)}_0$. This is another form of the fluctuation dissipation theorem.